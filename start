#!/bin/bash

# This script starts up all the applications I use on a daily basis.
# When remote, I have to connect to the vpn first and then run this script.

LOG=~/.local/log/start.log

mkdir -p "$(dirname $LOG)"

date > "$LOG"
# Installed the wiki in bun, so have to run it in bun.
echo Starting tiddlywiki. | tee -a "$LOG"
cd ~/projects/wiki && nohup bun run tiddlywiki arbor --listen port=9999 &>> $LOG &
# emacs --daemon &>> "$LOG" &
# firefox &>> "$LOG" &
echo Starting chromium. | tee -a "$LOG"
flatpak run org.chromium.Chromium &>> "$LOG" &
echo Starting slack. | tee -a "$LOG"
flatpak run com.slack.Slack &>> "$LOG" &
echo Starting webex. | tee -a "$LOG"
/opt/Webex/bin/CiscoCollabHost jgaines &>> "$LOG" &
# slack &>> "$LOG" &
# exo-open --launch WebBrowser &>> "$LOG" &
echo Starting pycharm. | tee -a "$LOG"
signal-reset pycharmp &>> "$LOG" &
# xfce4-terminal --tab --tab --tab &>> "$LOG"
# edit -c &>> "$LOG" &
# code /etc/hosts
# If weren't not on the vpn, then update all repos in the background.
if ip addr show tun0 &>> /dev/null; then
    echo "On VPN, not updating repos, mise or pipx." | tee -a "$LOG"
else
    echo "Not on VPN, updating repos." | tee -a "$LOG"
    update-all-repos &> ~/Desktop/update-all-repos.txt &
    echo "Updating mise." | tee -a "$LOG"
    mise self-update -y &>> "$LOG" &
    echo "Updating pipx." | tee -a "$LOG"
    pipx upgrade-all &>> "$LOG" &
fi
cd
